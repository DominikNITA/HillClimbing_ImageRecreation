@using ApexCharts;

<ApexChart @ref="_chart" TItem="AlgorithmResult" Title="Score by iteration" Options="_options">
    <ApexPointSeries TItem="AlgorithmResult"
                     Items="AlgorithmResults"
                     Name="Score"
                     SeriesType="SeriesType.Line"
                     XValue="@(e => e.Iteration)"
                     YValue="@(e => (decimal)Algorithm.GetScorePercentage(e.Score ?? 0,Analysis?.Width, Analysis?.Height))" />
</ApexChart>
@code {
    [Parameter]
    public IEnumerable<AlgorithmResult> AlgorithmResults { get; set; }

    [Parameter]
    public AnalysisResult Analysis { get; set; }

    private ApexChart<AlgorithmResult>? _chart;

    private ApexChartOptions<AlgorithmResult> _options = new();

    protected override void OnInitialized()
    {
        _options.Xaxis = new()
            {
                Type = XAxisType.Numeric,
                TickAmount = 10,
                DecimalsInFloat = 0
            };
                    _options.Tooltip = new()
            {
                Y = new()
                {
                    Formatter = @"function(value, { series, seriesIndex, dataPointIndex, w }) { return value + '%' }"
                },
            };
        _options.Yaxis = new();
        _options.Yaxis.Add(new()
            {
                DecimalsInFloat = 2,
                Title = new() { Text = "Score"},
                Labels = new YAxisLabels() { Formatter = @"function(value) { return value + '%' }" }           
            });
    }
}
